<?xml version="1.0" encoding="utf-8"?>
<entity-mappings version="2.1"
  xmlns="http://xmlns.jcp.org/xml/ns/persistence/orm"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence/orm
http://xmlns.jcp.org/xml/ns/persistence/orm_2_1.xsd">

  <named-native-query
    name="Litige.allLitigeAPayer"
    result-class="fr.microtec.geo2.persistance.entity.litige.GeoLitigeAPayer"
  >
    <query>
    <![CDATA[
      SELECT rownum, data.* FROM(
        select 'C/' "TYPE", C.CLI_CODE "CODE", C.RAISOC "RAISOC", 1 "NUM_TRI"
        FROM   GEO_LITIGE L,GEO_ORDRE O,GEO_CLIENT C
        where   L.LIT_REF =:arg_lit_ref and
                    L.ORD_REF_ORIGINE =  O.ORD_REF and
                    O.CLI_REF = C.CLI_REF
        union
        select 'F/' "TYPE",F.FOU_CODE "CODE", F.RAISOC "RAISOC", 2 "NUM_TRI"
        FROM   GEO_LITIGE L,GEO_ORDLIG OL, GEO_LITLIG LL,GEO_FOURNI F
        where   LL.LIT_REF =:arg_lit_ref                     and
                    L.LIT_REF = LL.LIT_REF        			and
                    L.ORD_REF_ORIGINE =  OL.ORD_REF  and
                    OL.FOU_CODE = F.FOU_CODE
        union
        select  'T/' "TYPE",T.TRP_CODE "CODE", T.RAISOC "RAISOC", 3 "NUM_TRI"
        FROM   GEO_TRANSP  T
        where  T.VALIDE ='O') data
    ]]>
    </query>
  </named-native-query>

  <named-native-query
    name="Litige.allLitigeLigneFait"
    result-class="fr.microtec.geo2.persistance.entity.litige.GeoLitigeLigneFait"
  >
    <query>
    <![CDATA[
      SELECT rownum, data.* FROM(
        SELECT
            LL.lil_ref,
            litige_fait.TOT_NB_COL,
            litige_fait.TOT_PDS_NET,
            litige_fait.TOT_NB_PAL
        FROM
            geo_litlig LL,
            geo_ordlig OL,
            geo_article A,
            geo_ordre O,
            (
            SELECT
                LL1.ORL_REF "ORL_REF",
                            sum(LL1.CLI_NB_COL) "TOT_NB_COL",
                sum(LL1.CLI_PDS_NET) "TOT_PDS_NET",
                sum(LL1.CLI_NB_PAL) "TOT_NB_PAL"
            FROM
                GEO_LITIGE L1 ,
                GEO_LITLIG LL1
            WHERE
                L1.lit_ref = :ar_lit_ref
                AND
                            L1.LIT_REF = LL1.LIT_REF
                AND
        LL1.ORL_LIT <> :ar_orl_lit
            GROUP BY
                LL1.ORL_REF) litige_fait
        WHERE
            OL.orl_ref = LL.orl_ref
            AND
        A.art_ref = OL.art_ref
            AND
        LL.lit_ref = :ar_lit_ref
            AND
        O.ORD_REF = OL.ORD_REF
            AND
        LL.ORL_LIT = :ar_orl_lit
            AND
        litige_fait.ORL_REF(+) = LL.ORL_REF
        ORDER BY
            OL.orl_lig ASC) data
    ]]>
    </query>
  </named-native-query>

</entity-mappings>
